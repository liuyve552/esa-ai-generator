@tailwind base;
@tailwind components;
@tailwind utilities;

html,
body {
  height: 100%;
}

:root {
  --esa-bg: #0b0b12;
  --esa-fg: #f4f4f5;
  --esa-accent: #f97316;
  --esa-accent-rgb: 249 115 22;
  --esa-weather-aura-1: var(--esa-accent-rgb);
  --esa-weather-aura-2: 46 16 101;
  /* Background theme (user toggle) */
  --esa-bg-theme-1: 46 16 101; /* #2E1065 */
  --esa-bg-theme-2: 124 58 237; /* #7C3AED */
}

body {
  @apply bg-zinc-50 text-zinc-900 antialiased dark:bg-black dark:text-white;
}

html.weather-clear {
  --esa-weather-aura-1: 56 189 248;
  --esa-weather-aura-2: 125 211 252;
}

html.weather-cloud {
  --esa-weather-aura-1: 148 163 184;
  --esa-weather-aura-2: 71 85 105;
}

html.weather-rain {
  --esa-weather-aura-1: 56 189 248;
  --esa-weather-aura-2: 2 132 199;
}

html.weather-snow {
  --esa-weather-aura-1: 226 232 240;
  --esa-weather-aura-2: 148 163 184;
}

html.weather-fog {
  --esa-weather-aura-1: 203 213 225;
  --esa-weather-aura-2: 71 85 105;
}

html.weather-night {
  --esa-weather-aura-2: 30 58 138;
}

/* Background theme presets (toggle via html[data-bg]) */
html[data-bg="purple"] {
  --esa-bg-theme-1: 46 16 101;
  --esa-bg-theme-2: 124 58 237;
}

html[data-bg="ocean"] {
  --esa-bg-theme-1: 2 132 199; /* sky */
  --esa-bg-theme-2: 37 99 235; /* blue */
}

html[data-bg="forest"] {
  --esa-bg-theme-1: 5 150 105; /* emerald */
  --esa-bg-theme-2: 16 185 129; /* teal */
}

html[data-bg="rose"] {
  --esa-bg-theme-1: 219 39 119; /* fuchsia */
  --esa-bg-theme-2: 244 63 94; /* rose */
}

html.dark {
  color-scheme: dark;
}

html.light {
  color-scheme: light;
}

.leaflet-container {
  width: 100%;
  height: 100%;
  border-radius: 1rem;
}

/* ---------------------------------------
   Weather FX (lightweight, no framework)
   Controlled by html.weather-*
---------------------------------------- */
.esa-fx {
  position: absolute;
  inset: 0;
  z-index: 10;
  opacity: 0;
  transition: opacity 700ms ease;
  will-change: transform, opacity;
}

.esa-fx-noise {
  opacity: 0.16;
  background-image: radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.06), transparent 28%),
    radial-gradient(circle at 80% 10%, rgba(255, 255, 255, 0.04), transparent 30%),
    radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.03), transparent 32%);
  filter: blur(0.2px);
}

html.weather-clear .esa-fx-sun {
  opacity: 0.7;
}

.esa-fx-sun {
  background-image: radial-gradient(circle at 72% 22%, rgba(253, 230, 138, 0.12), transparent 52%),
    radial-gradient(circle at 16% 16%, rgba(56, 189, 248, 0.10), transparent 55%),
    radial-gradient(circle at 50% 80%, rgba(124, 58, 237, 0.08), transparent 60%);
  animation: esa-fx-drift 10s ease-in-out infinite;
  mix-blend-mode: screen;
}

html.weather-rain .esa-fx-rain {
  opacity: 0.85;
}

.esa-fx-rain {
  background-image: repeating-linear-gradient(
    105deg,
    rgba(125, 211, 252, 0.12) 0px,
    rgba(125, 211, 252, 0.12) 1px,
    transparent 1px,
    transparent 10px
  );
  background-size: 220px 220px;
  animation: esa-fx-rain 1.25s linear infinite;
  mix-blend-mode: screen;
  filter: blur(0.2px);
}

html.weather-snow .esa-fx-snow {
  opacity: 0.95;
}

.esa-fx-snow {
  background-image: radial-gradient(circle, rgba(226, 232, 240, 0.9) 0.6px, transparent 1.4px),
    radial-gradient(circle, rgba(226, 232, 240, 0.65) 0.7px, transparent 1.6px),
    radial-gradient(circle, rgba(226, 232, 240, 0.5) 0.8px, transparent 1.8px);
  background-size: 120px 120px, 180px 180px, 240px 240px;
  animation: esa-fx-snow 7.5s linear infinite;
  filter: blur(0.1px);
  mix-blend-mode: screen;
}

html.weather-fog .esa-fx-fog {
  opacity: 0.9;
}

.esa-fx-fog {
  background-image: radial-gradient(circle at 30% 40%, rgba(255, 255, 255, 0.12), transparent 55%),
    radial-gradient(circle at 70% 55%, rgba(255, 255, 255, 0.08), transparent 58%),
    radial-gradient(circle at 42% 68%, rgba(203, 213, 225, 0.10), transparent 62%);
  animation: esa-fx-fog 12s ease-in-out infinite;
  filter: blur(10px);
}

@keyframes esa-fx-drift {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% {
    transform: translate3d(0, -1.2%, 0) scale(1.02);
  }
  100% {
    transform: translate3d(0, 0, 0) scale(1);
  }
}

@keyframes esa-fx-rain {
  0% {
    transform: translate3d(0, -18%, 0);
  }
  100% {
    transform: translate3d(0, 18%, 0);
  }
}

@keyframes esa-fx-snow {
  0% {
    transform: translate3d(0, -10%, 0);
  }
  100% {
    transform: translate3d(0, 10%, 0);
  }
}

@keyframes esa-fx-fog {
  0% {
    transform: translate3d(-1.2%, 0, 0) scale(1.02);
  }
  50% {
    transform: translate3d(1.2%, -0.6%, 0) scale(1.05);
  }
  100% {
    transform: translate3d(-1.2%, 0, 0) scale(1.02);
  }
}

/* Mystic loading ellipsis */
.esa-loading-dots::after {
  content: "...";
  display: inline-block;
  overflow: hidden;
  vertical-align: bottom;
  width: 0;
  animation: esa-dots 1.2s steps(4, end) infinite;
}

@keyframes esa-dots {
  to {
    width: 1.2em;
  }
}
